<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Fake News Detector</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

    <style>
        body {
            background-color: #121212;
            color: #f0f0f0;
            padding-top: 40px;
            font-family: 'Segoe UI', sans-serif;
        }

        h1 {
            font-weight: bold;
            color: #00ffcc;
            text-shadow: 0 0 10px #00ffcc;
        }

        .form-control {
            background-color: #1e1e1e;
            color: #fff;
            border: 1px solid #444;
        }

        .form-control::placeholder {
            color: #888;
        }

        .btn-success {
            background-color: #00b894;
            border: none;
        }

        .btn-success:hover {
            background-color: #00cec9;
        }

        #loadingSpinner {
            display: none;
        }

        .result {
            background-color: #1f1f1f;
            border-left: 5px solid #00ffcc;
        }

        .confidence-bar {
            width: 100%;
            height: 18px;
            background-color: #333;
            border-radius: 10px;
            overflow: hidden;
        }

        .confidence-fill {
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s ease;
        }

        #errorMessage {
            color: #f44336;
            font-weight: bold;
        }

        .quiz {
            background-color: #1c1c1c;
            border-left: 4px solid #00bcd4;
        }

        .quiz .form-check-input:checked + .form-check-label {
            color: #00bcd4;
        }

        #quizResult {
            font-weight: bold;
        }
    </style>
</head>
<body>

<div class="container">
    <h1 class="text-center mb-4">üß† AI Fake News Detector</h1>

    <!-- Prediction Form -->
    <form id="predictForm" method="POST" action="/predict" onsubmit="return validateInput()">
        <div class="mb-3">
            <textarea class="form-control" name="news" rows="6" placeholder="Paste a news article or paragraph here...">{{ input_text }}</textarea>
        </div>
        <div id="errorMessage" class="mb-3"></div>
        <button type="submit" class="btn btn-success w-100">üîç Predict</button>
    </form>

    <!-- Spinner -->
    <div class="d-flex justify-content-center mt-4">
        <div id="loadingSpinner" class="spinner-border text-success" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
    </div>

    {% if prediction %}
        <!-- Result -->
        <div class="result mt-5 p-4 rounded">
            <h5><strong>Prediction:</strong> 
                {{ prediction == 'Fake' and '‚ùå Fake News' or '‚úÖ Real News' }}
            </h5>
            <div class="mt-3">
                <strong>Confidence:</strong> {{ confidence }}%
                <div class="confidence-bar mt-1">
                    <div class="confidence-fill"
                         style="width: {{ confidence }}%; background-color: {% if confidence >= 80 %}#00ff88{% elif confidence >= 50 %}#ffa500{% else %}#ff5555{% endif %};">
                    </div>
                </div>
            </div>
        </div>

        <!-- Awareness Quiz -->
        <div class="quiz mt-5 p-4 rounded">
            <h4>üßê Fake News Awareness Quiz</h4>

            <div class="mt-3">
                <p><strong>1. What is one common sign of fake news?</strong></p>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="q1" value="a">
                    <label class="form-check-label">a) Verified author</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="q1" value="b">
                    <label class="form-check-label">b) Sensational headlines</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="q1" value="c">
                    <label class="form-check-label">c) Proper grammar</label>
                </div>
            </div>

            <div class="mt-4">
                <p><strong>2. What should you do when you see shocking news on social media?</strong></p>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="q2" value="a">
                    <label class="form-check-label">a) Immediately share it</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="q2" value="b">
                    <label class="form-check-label">b) Trust it if it's trending</label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="q2" value="c">
                    <label class="form-check-label">c) Cross-check with trusted sources</label>
                </div>
            </div>

            <button class="btn btn-primary mt-3" onclick="checkQuiz()">‚úÖ Submit Quiz</button>
            <div id="quizResult" class="mt-3"></div>
        </div>
    {% endif %}
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<!-- JavaScript -->
<script>
    const form = document.getElementById('predictForm');
    const spinner = document.getElementById('loadingSpinner');

    form.addEventListener('submit', function () {
        spinner.style.display = 'block';
    });

    function validateInput() {
        const textarea = document.querySelector('textarea[name="news"]');
        const errorDiv = document.getElementById('errorMessage');
        if (!textarea.value.trim()) {
            errorDiv.textContent = "‚ö†Ô∏è Please enter some text before submitting.";
            spinner.style.display = 'none';
            return false;
        }
        errorDiv.textContent = "";
        return true;
    }

    function checkQuiz() {
        const q1 = document.querySelector('input[name="q1"]:checked');
        const q2 = document.querySelector('input[name="q2"]:checked');
        let score = 0;
        let feedback = "";

        if (q1 && q1.value === "b") score++;
        if (q2 && q2.value === "c") score++;

        if (!q1 || !q2) {
            feedback = "<p class='text-danger'>‚ö†Ô∏è Please answer both questions.</p>";
        } else {
            feedback = `<p>You got <strong>${score}/2</strong> correct.</p>`;
            feedback += "<p class='text-success'>‚úîÔ∏è Great job! Stay alert to misinformation.</p>";
        }

        document.getElementById("quizResult").innerHTML = feedback;
    }
</script>

</body>
</html>
